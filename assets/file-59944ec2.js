import{_ as K}from"./Button-0333f1c2.js";import{_ as T,u as x,a as $,r as A,b as O,c as d,d as t,n as h,e as a,f as C,w as k,t as w,g as S,h as P,F as B,i as U,j as V,v as I,k as j,o,l as m}from"./index-f4199718.js";const b=async(p,c)=>{if(!c)return"";typeof c=="string"&&(c=new TextEncoder().encode(c));const e=await crypto.subtle.digest(p,c);return Array.from(new Uint8Array(e)).map(n=>n.toString(16).padStart(2,"0")).join("")},E=async(p,c)=>{const e=c||crypto.getRandomValues(new Uint8Array(32)),r=await crypto.subtle.importKey("raw",p,"PBKDF2",!1,["deriveBits"]),u=await crypto.subtle.deriveBits({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},r,640);return{cryptKey:await crypto.subtle.importKey("raw",u.slice(0,32),{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]),signKey:await crypto.subtle.importKey("raw",u.slice(32,64),{name:"HMAC",hash:"SHA-256"},!0,["sign","verify"]),iv:u.slice(64),salt:e}},L=async(p,c)=>{const e=new TextEncoder("utf-8"),r=e.encode(p),u=e.encode(c),n=await E(u),l=new Uint8Array(await crypto.subtle.sign("HMAC",n.signKey,r));let i=new Uint8Array(r.length+32);i.set(l,0),i.set(r,32);const f=new Uint8Array(await crypto.subtle.encrypt({name:"AES-CBC",iv:n.iv},n.cryptKey,i));return i=new Uint8Array(f.length+32),i.set(n.salt,0),i.set(f,32),i},R=async(p,c)=>{const e=new TextEncoder("utf-8").encode(c),r=await E(e,p.slice(0,32));let u;try{u=new Uint8Array(await crypto.subtle.decrypt({name:"AES-CBC",iv:r.iv},r.cryptKey,p.slice(32)))}catch{throw new Error("Key mismatch")}const n=u.subarray(0,32),l=u.subarray(32);if(!await crypto.subtle.verify("HMAC",r.signKey,n,l))throw new Error("Signature mismatch.");return new TextDecoder("utf-8").decode(l)},z="file_eD8rOr",J="hash_tuFA49",Y="base_n1rPdD",W="info_Rc0byY",X="openfile_odDXBJ",q="closefile_mR6Ii9",G="copied_ekpYx3",Q={file:z,hash:J,base:Y,info:W,openfile:X,closefile:q,copied:G},Z=a("h1",null,"File encryptor / checker",-1),ee={key:0},te=a("h2",null,"File",-1),se={key:0},ae={key:1},ne={key:1},le=a("h3",null,"Hashes:",-1),ie=["onClick"],oe=a("p",null,"Copied to clipboard!",-1),ce=[oe],re={key:1},ue=a("p",null,"File System Access API is not supported",-1),de=[ue],ye={__name:"file",setup(p){const e=x({dataType:"ArrayBuffer",acceptAllTypes:!0,multiple:!1}),{copy:r,copied:u}=$(),n=A(""),l=A(""),i=O({}),f=A(0),g=A(!1);function H(){e.file.value=null,e.data.value=null,n.value="",l.value="",f.value=0}async function M(){e.saveAs({suggestedName:n.value||e.fileName.value})}async function F(){if(!l.value)return M();const v=new TextDecoder("utf-8").decode(e.data.value),y=JSON.stringify(v);e.data.value=await L(y,l.value),e.saveAs({suggestedName:e.fileName.value+".enc",types:[{description:"Encrypted file",accept:{"text/plain":[".enc"]}}]})}async function N(){g.value=!1;const s=l.value;if(!s)return g.value=!0,e.open();await e.open({types:[{description:"Encrypted file",accept:{"text/plain":[".enc"]}}]});try{const v=await R(e.data.value,s);e.data.value=JSON.parse(v),l.value="";const y=e.fileName.value;y.endsWith(".enc")?n.value=y.slice(0,y.length-4):n.value=n+".dec",g.value=!0}catch(v){e.data.value=null,console.error(v)}}async function D(){if(f.value=1,!e.data.value)return;const s={};s.sha1=await b("SHA-1",e.data.value),s.sha256=await b("SHA-256",e.data.value),s.sha384=await b("SHA-384",e.data.value),s.sha512=await b("SHA-512",e.data.value),Object.assign(i,s),f.value=2}return(s,v)=>{const y=K;return o(),d(B,null,[Z,t(e).isSupported?(o(),d("div",{key:0,class:h(s.$style.file)},[!t(e).data.value||!t(g)?(o(),d("div",ee,[a("div",{class:h(s.$style.file)},[C(y,{onClick:N},{default:k(()=>[m(w(t(l).length?"Decrypt":"Open")+" file ",1)]),_:1})],2)])):(o(),d("div",{key:1,class:h(s.$style.base)},[a("div",null,[a("div",{class:h(s.$style.file)},[C(y,{onClick:F},{default:k(()=>[m(w(t(l).length?"Encrypt":"Save")+" file ",1)]),_:1})],2),a("div",{class:h(s.$style.info)},[te,a("p",null,"Name: "+w(t(n)||t(e).fileName.value),1),a("p",null,"Size: "+w(t(e).fileSize.value),1),t(e).fileMIME.value?(o(),d("p",se,"Media Type: "+w(t(e).fileMIME.value),1)):S("",!0),t(e).fileLastModified.value?(o(),d("p",ae,"Last Modified: "+w(new Date(t(e).fileLastModified.value)),1)):S("",!0),a("div",{class:h(s.$style.hash)},[t(f)===0?(o(),P(y,{key:0,onClick:D},{default:k(()=>[m(" Calculate hashes ")]),_:1})):t(f)===1?(o(),d("p",ne,"Calculating hashes...")):(o(),d(B,{key:2},[le,a("ul",null,[(o(!0),d(B,null,U(Object.keys(t(i)),_=>(o(),d("li",{key:t(i)[_]},[a("p",null,[m(w(_)+": ",1),a("code",{onClick:fe=>t(r)(t(i)[_])},w(t(i)[_]),9,ie)])]))),128))]),t(u)?(o(),d("div",{key:0,class:h(s.$style.copied)},ce,2)):S("",!0)],64))],2)],2),C(y,{onClick:H,class:h(s.$style.closefile)},{default:k(()=>[m(" Close File ")]),_:1},8,["class"])])],2)),a("div",null,[V(a("input",{"onUpdate:modelValue":v[0]||(v[0]=_=>j(l)?l.value=_:null),type:"password",placeholder:"Password"},null,512),[[I,t(l)]])])],2)):(o(),d("div",re,de))],64)}}},pe={$style:Q},we=T(ye,[["__cssModules",pe]]);export{we as default};
